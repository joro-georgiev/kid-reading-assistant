<!DOCTYPE html>
<html lang="en" data-i18n-title="title.read">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Assistant - Read Aloud!</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="header">
        <a href="index.html" data-i18n="header.appName">Reading Assistant</a>
    </div>

    <div class="container">
        <div class="speech-warning" id="speech-warning" data-i18n="read.speechWarning">
            Your browser does not support speech recognition.
            Please use Google Chrome for the best experience.
        </div>

        <div class="reading-area" id="reading-area">
            <button class="mic-btn" id="mic-btn" title="Start reading" data-i18n-title="read.micTitle">
                &#127908;
            </button>

            <img class="story-hero" id="story-image" style="display:none" alt="">
            <div class="story-title" id="story-title" data-i18n="read.storyLoading">Loading...</div>
            <div class="word-display" id="word-display"></div>

            <div class="status-bar" id="status-bar"></div>

            <div style="text-align: center;">
                <button class="done-btn" id="done-btn" data-i18n="read.doneBtn">I'm Done!</button>
            </div>
        </div>

        <div class="results-panel" id="results-panel">
            <div class="section-title" data-i18n="read.greatReading">Great Reading!</div>
            <div class="score" id="result-score"></div>
            <div class="message" id="result-message"></div>
            <div class="stats" id="result-stats"></div>
            <button class="try-again-btn" id="try-again-btn" data-i18n="read.tryAgain">Try Again</button>
            <a href="index.html" class="home-btn" data-i18n="read.pickAnother">Pick Another Story</a>
        </div>
    </div>

    <script>
    // On-screen debug console for mobile
    (function() {
        var css = document.createElement('style');
        css.textContent =
            '#dbg-btn{position:fixed;top:8px;left:8px;z-index:10000;background:rgba(0,0,0,.3);color:#fff;border:none;border-radius:6px;padding:4px 10px;font:12px monospace;opacity:.5}' +
            '#dbg-panel{display:none;position:fixed;top:0;left:0;bottom:0;width:75vw;max-width:360px;z-index:9999;background:rgba(0,0,0,.92);color:#0f0;font:12px monospace;overflow-y:auto;padding:6px}' +
            '#dbg-panel.open{display:block}' +
            '#dbg-panel.full{width:100vw;max-width:none}' +
            '#dbg-bar{position:sticky;top:0;background:rgba(0,0,0,.92);padding:4px 0;margin-bottom:4px}' +
            '#dbg-bar button{background:rgba(255,255,255,.15);color:#aaa;border:none;border-radius:4px;padding:2px 8px;font:11px monospace;margin-right:4px}' +
            '.dbg-w{color:#ffa726}.dbg-e{color:#ef5350}';
        document.head.appendChild(css);

        var btn = document.createElement('button');
        btn.id = 'dbg-btn';
        btn.textContent = '\uD83D\uDC1B debug';
        document.body.appendChild(btn);

        var panel = document.createElement('div');
        panel.id = 'dbg-panel';
        panel.innerHTML = '<div id="dbg-bar"><button id="dbg-close">close</button><button id="dbg-expand">expand</button></div>';
        document.body.appendChild(panel);

        btn.onclick = function() { panel.className = 'open'; btn.style.display = 'none'; };
        document.getElementById('dbg-close').onclick = function() { panel.className = ''; btn.style.display = ''; };
        var full = false;
        document.getElementById('dbg-expand').onclick = function() {
            full = !full;
            panel.className = full ? 'open full' : 'open';
            this.textContent = full ? 'collapse' : 'expand';
        };

        var colors = { warn: ' dbg-w', error: ' dbg-e' };
        function add(level, args) {
            var d = document.createElement('div');
            d.className = colors[level] || '';
            var p = [];
            for (var i = 0; i < args.length; i++) {
                var a = args[i];
                p.push(typeof a === 'object' ? JSON.stringify(a) : String(a));
            }
            d.textContent = p.join(' ');
            panel.appendChild(d);
            panel.scrollTop = panel.scrollHeight;
        }

        var oLog = console.log, oWarn = console.warn, oErr = console.error;
        console.log = function() { oLog.apply(console, arguments); add('log', arguments); };
        console.warn = function() { oWarn.apply(console, arguments); add('warn', arguments); };
        console.error = function() { oErr.apply(console, arguments); add('error', arguments); };
        window.onerror = function(m, f, l) { add('error', ['Uncaught: ' + m + ' (' + f + ':' + l + ')']); };

        add('log', ['debug console ready']);
    })();
    </script>
    <script src="js/i18n.js"></script>
    <script src="js/app.js"></script>
    <script src="js/speech.js"></script>
    <script src="js/reader.js"></script>
</body>
</html>
